name: Clean Repo Check

on:
  push:
  pull_request:

jobs:
  check-clean-repo:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Find disallowed files
      run: |
        echo "üîç Scanning for forbidden files..."
        forbidden=$(find . \( \
          -name '.DS_Store' -o \
          -name '*.log' -o \
          -name '.zsh_history' -o \
          -name '.bash_history' -o \
          -path './Library/CloudStorage/*' -o \
          -path './Trash/*' -o \
          -path './OneDrive-*/*' -o \
          -name '.env' -o \
          -name 'venv' -o \
          -name '.venv' \
        \) -print)

        if [[ -n "$forbidden" ]]; then
          echo "‚ùå Forbidden files detected:"
          echo "$forbidden"
          exit 1
        else
          echo "‚úÖ No forbidden files found."
        fi

    - name: Optional ‚Äì Lint Python files
      run: |
        echo "üßº Running Python linting..."
        pip install black
        black --check .